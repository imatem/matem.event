<tal:manager replace="structure provider:collage.ContentManager" />

<style type="text/css">
  .text-danger{
          background-color: #FF0000;
          color:#FFFFFF;
          text-transform: lowercase;
      }
  .jurheader-color{
    background-color: #944ADF;
  }

  .cuheader-color{
    background-color: #4387fd;
  }

</style>

<tal:variables define="plone_view here/@@plone;
                       toLocalizedTime nocall: plone_view/toLocalizedTime;
                       isAnon view/isAnon;
                       mtool view/mtool;
                       portal_url view/portal_url;
                       normalizeString view/normalizeString;
                       site_properties view/site_properties;
                       topic_title here/Title | nothing;
                       topic_style python:view.topicstyle(topic_title);">
  <div tal:attributes="class topic_style"
       tal:define="topicContents view/getContents;">

    <tal:listing i18n:domain="plone"
                 define="myview context/@@collage_kss_helper/getKssView;
                         getKssClasses python: myview.getKssClasses;
                         templateId string:folder_summary_view;
                         month_name python:{'Jan.': 'Enero', 'Feb.':'Febrero', 'Mar.':'Marzo', 'Apr.':'Abril', 'May':'Mayo', 'June':'Junio', 'July':'Julio', 'Aug.':'Agosto', 'Sep.':'Septiembre', 'Oct.':'Octubre', 'Nov.':'Noviembre', 'Dec.':'Diciembre'};
                         ">
      <tal:block tal:define="ptitle here/Title | nothing;
          cstyle python:view.cstyle(ptitle);">
        <br/>
        <h3 style="width: 47%;" tal:attributes="class cstyle">
          <font color="#FFFFFF">&nbsp; <span tal:content="ptitle"/></font>  &nbsp;</h3>


      <dl tal:condition="topicContents" >
        <tal:entry tal:repeat="item topicContents">
          <div class="tileItem">
            <tal:block tal:define="item_url item/getURL|item/absolute_url;
                                item_title_or_id item/pretty_title_or_id;
                                item_description item/Description;
                                item_date item/start/pCommon|nothing;
                                item_location item/location|nothing;
                                item_subjects item/Subject|None;
                                item_seminary python: item_subjects and item_subjects[0] or None;
                                item_expositor item/getSpeaker|nothing;
                                item_institution item/getEventInstitution|nothing;
                                item_isCanceled item/isCanceled|nothing;
                                date_s python:item_date and item_date.split(' ') or '';
                                fancy_date python:date_s and date_s[1].replace(',', '') +' de '+ month_name[date_s[0]] + ', ' +  date_s[3] + ' ' + date_s[4] + '.' or '';
                                ">
              <metal:block>
                <dt>
                  <span>
                    <span tal:attributes="class cstyle">
                      <font color="#FFFFFF">&nbsp;</font>  &nbsp;</span>
                  </span>
                  <span tal:condition="item_isCanceled">
                    <span style="background-color: #FF0000;"><font color="#FFFFFF">&nbsp; Cancelado</font>  &nbsp;</span>
                  </span><!-- end is canceled-->
                  <span class="summary">
                    <a href="#" tal:content="item_title_or_id" tal:attributes="href item_url">Title</a>
                    <br/>
                  </span>
                </dt>
                <dd>
                  <span tal:condition="item_institution">
                    <b><span tal:condition="item_expositor" tal:content="item_expositor"/><span tal:condition="item_institution" tal:content="python:' (' + item_institution + ').'"/></b>
                  </span>

                  <span tal:condition="python: not item_institution">
                    <b><span tal:condition="item_expositor" tal:content="python:item_expositor+'.'"/></b>
                  </span>
                  <span tal:content="item_description"/><br/>
                  <span tal:content="fancy_date"/>
                  <span tal:content="python:item_location"/>
                  <br/>
                  <span tal:content="item_seminary"/> <br/>
                </dd>
            </metal:block>

          </tal:block>

        </div>
        </tal:entry>
      </dl>
      </tal:block>
    </tal:listing>

  </div>

</tal:variables>

